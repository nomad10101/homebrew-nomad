# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Cagent < Formula
  desc ""
  homepage "https://github.com/nomad10101/cloudback"
  version "0.0.18"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/nomad10101/portola-release/releases/download/v0.0.18/portola-release_Darwin_x86_64.tar.gz"
      sha256 "cafdeb2540ae21fcd9358d69a4150ec8bfef5d532380e1a17ae0048865f6fe83"

      def install
        bin.install "cagent"
        prefix.install Dir["assets"]
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/nomad10101/portola-release/releases/download/v0.0.18/portola-release_Darwin_arm64.tar.gz"
      sha256 "da676bf4452fe1f2f06bda4c99ee4a9fe31551fdcfe31c520928887c0b082072"

      def install
        bin.install "cagent"
        prefix.install Dir["assets"]
      end
    end
  end

  on_linux do
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/nomad10101/portola-release/releases/download/v0.0.18/portola-release_Linux_arm64.tar.gz"
      sha256 "58f0c6d6eb0e31166b4249a9cda974ee698de5b4609be976a6e6a8b17d2de683"

      def install
        bin.install "cagent"
        prefix.install Dir["assets"]
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/nomad10101/portola-release/releases/download/v0.0.18/portola-release_Linux_x86_64.tar.gz"
      sha256 "19a6267144bf71be3726036cd6f6a326989b15f9c38c321186c85596e73ee6ee"

      def install
        bin.install "cagent"
        prefix.install Dir["assets"]
      end
    end
  end

  def caveats
    <<~EOS
      ****************************************************************
      Listen up...
      ****************************************************************
    EOS
  end

  service do
    run [opt_bin/"cagent, "--assets-path", opt_prefix/"assets"]
    environment_variables OIQ_OTEL_COLLECTOR_HOME: opt_prefix
    keep_alive true
  end
end
